# Configuration Docker Compose pour la production
# Usage: docker-compose -f docker-compose.yml -f docker-compose.prod.yml up -d

version: '3.8'

services:
  backend:
    environment:
      - NODE_ENV=production
      - FRONTEND_URL=${FRONTEND_URL:-http://localhost:5173}
    # En production, on peut retirer les volumes pour utiliser l'image buildée
    # volumes:
    #   - ./backend/src:/app/src
    #   - ./backend/migrations:/app/migrations
    restart: unless-stopped

  frontend:
    environment:
      - NODE_ENV=production
      - VITE_API_URL=${VITE_API_URL:-http://localhost:3000/api}
    restart: unless-stopped

  postgres:
    restart: unless-stopped
    # En production, vous pouvez vouloir limiter l'accès au port
    # ports:
    #   - "127.0.0.1:5432:5432"  # Seulement accessible localement
